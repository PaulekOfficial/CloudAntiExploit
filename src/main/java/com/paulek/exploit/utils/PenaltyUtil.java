package com.paulek.exploit.utils;

import com.paulek.exploit.Antiexploit;
import com.paulek.exploit.data.SimplePackets;
import org.bukkit.Bukkit;
import org.bukkit.command.ConsoleCommandSender;
import org.bukkit.entity.Player;

public class PenaltyUtil {

    public static void penalty(Player player){

        if (SimplePackets.isPerm()) {

            String ip = player.getAddress().toString();
            String[] spilt_a = ip.split("/");
            String[] split_b = spilt_a[1].split(":");
            String ip_address = split_b[0];

            ConsoleCommandSender ccs = Bukkit.getServer().getConsoleSender();

            for (String s : SimplePackets.getPenalty()) {

                s = s.replaceAll("%ip%", ip_address).replace("%nick%", player.getDisplayName());

                try {
                    Bukkit.dispatchCommand(ccs, s);
                } catch (Exception e) {

                    Antiexploit.getPlugin().getLogger().warning("Error while invoking the command");

                }

            }
        }

        Bukkit.getScheduler().runTask(Antiexploit.getPlugin(), new Runnable() {

            @Override
            public void run() {
                if(player.isOnline()) player.kickPlayer(ColorUtil.fix(SimplePackets.getKick_message()));
            }
        });
    }

}
