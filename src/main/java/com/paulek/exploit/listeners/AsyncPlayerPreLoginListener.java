package com.paulek.exploit.listeners;

import com.paulek.exploit.data.SimplePackets;
import com.paulek.exploit.utils.ColorUtil;
import org.bukkit.Bukkit;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.player.AsyncPlayerPreLoginEvent;

public class AsyncPlayerPreLoginListener implements Listener {

    @EventHandler
    public void onQuit(AsyncPlayerPreLoginEvent e){

        String host = e.getAddress().getHostName();

        int found = 0;

        for(Player p : Bukkit.getOnlinePlayers()){

            if(p.getAddress().getHostName().equalsIgnoreCase(host)) found++;

        }

        if(found >= SimplePackets.getMax_ip()){

            e.disallow(AsyncPlayerPreLoginEvent.Result.KICK_FULL, ColorUtil.fix(SimplePackets.getToo_mutch_ip()));

        }

    }

}
